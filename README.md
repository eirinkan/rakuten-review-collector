# 楽天市場レビュー収集 Chrome拡張機能

楽天市場の商品レビューを自動収集し、スプレッドシートに保存またはCSVファイルとしてダウンロードするChrome拡張機能です。

## 機能

- 楽天市場のレビューページから自動でレビューを収集
- ページネーションに対応（複数ページを自動巡回）
- ランダムウェイト（3-6秒）でサーバー負荷を軽減
- 2つの保存モード:
  - **スプレッドシート自動保存**: GAS URLを設定した場合
  - **CSVダウンロード**: GAS URLを設定しない場合

## 収集される情報

- 収集日時
- 商品名
- 商品URL
- 評価（星の数）
- レビュータイトル
- レビュー本文
- 投稿者名
- レビュー投稿日
- 購入情報（サイズ、カラーなど）
- 参考になった数
- ページURL

## インストール方法

### Chrome拡張機能のインストール

1. このリポジトリをダウンロードまたはクローン
2. Chromeで `chrome://extensions` を開く
3. 右上の「デベロッパーモード」をオンにする
4. 「パッケージ化されていない拡張機能を読み込む」をクリック
5. ダウンロードしたフォルダを選択

### Google Apps Script の設定（スプレッドシート保存を使う場合）

1. [Google スプレッドシート](https://sheets.google.com/)で新規スプレッドシートを作成
2. メニューから「拡張機能」→「Apps Script」を開く
3. `code.gs` の内容をコピーして貼り付け
4. 保存（Ctrl+S）
5. 「デプロイ」→「新しいデプロイ」をクリック
6. 「種類の選択」で「ウェブアプリ」を選択
7. 設定:
   - 説明: 任意（例: 楽天レビュー収集）
   - 次のユーザーとして実行: 自分
   - アクセスできるユーザー: **全員**
8. 「デプロイ」をクリック
9. 表示されたURLをコピー

### 拡張機能の設定

1. Chrome拡張機能のアイコンを右クリック →「オプション」
2. コピーしたGAS URLを入力して「保存」

## 使い方

1. 楽天市場の商品レビューページを開く
   - 例: `https://review.rakuten.co.jp/item/...`
2. 拡張機能のアイコンをクリック
3. 「収集開始」ボタンをクリック
4. 収集が完了するまで待つ（ページを閉じないでください）
5. 収集完了後:
   - GAS設定済み: 自動的にスプレッドシートに保存
   - GAS未設定: 「CSVダウンロード」ボタンでダウンロード

## ファイル構成

```
├── manifest.json     # 拡張機能のマニフェスト
├── popup.html        # ポップアップUI
├── popup.js          # ポップアップのスクリプト
├── options.html      # 設定画面
├── options.js        # 設定画面のスクリプト
├── content.js        # レビュー収集スクリプト
├── background.js     # バックグラウンド処理
├── code.gs           # GAS用スクリプト
└── icons/            # アイコン画像
```

## 注意事項

- 楽天市場の利用規約を確認し、個人利用の範囲でご使用ください
- 大量のリクエストはサーバーに負荷をかけるため、適度な間隔を空けてください
- 収集したデータの取り扱いは自己責任でお願いします

## ライセンス

MIT License
