<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¥½å¤©ãƒ¬ãƒ“ãƒ¥ãƒ¼åé›† - è¨­å®š</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', 'Hiragino Sans', 'Yu Gothic', sans-serif;
      background: #f5f5f5;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
    }

    .header {
      background: #BF0000;
      color: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 16px;
    }

    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header h1 {
      font-size: 20px;
    }

    .header-stats {
      display: flex;
      gap: 16px;
    }

    .header-stat {
      text-align: center;
    }

    .header-stat-value {
      font-size: 18px;
      font-weight: 700;
    }

    .header-stat-label {
      font-size: 10px;
      opacity: 0.8;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */
    .header-actions {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .header-icon-btn {
      background: rgba(255,255,255,0.15);
      border: none;
      color: white;
      padding: 8px;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .header-icon-btn:hover {
      background: rgba(255,255,255,0.25);
    }

    .header-link {
      background: rgba(255,255,255,0.15);
      color: white;
      padding: 8px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
    }

    .header-link:hover {
      background: rgba(255,255,255,0.25);
    }

    .help-card {
      display: none;
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    }

    .help-card.show {
      display: block;
    }

    .help-card h2 {
      font-size: 14px;
      color: #333;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid #eee;
    }

    .help-section {
      font-size: 13px;
      line-height: 1.8;
      color: #444;
    }

    .help-section h3 {
      font-size: 13px;
      color: #BF0000;
      margin: 16px 0 8px 0;
      padding-bottom: 4px;
      border-bottom: 1px solid #eee;
    }

    .help-section h3:first-child {
      margin-top: 0;
    }

    .help-section ol,
    .help-section ul {
      margin-left: 20px;
      margin-bottom: 8px;
    }

    .help-section li {
      margin-bottom: 8px;
    }

    .help-section p {
      margin-bottom: 8px;
      font-size: 12px;
      color: #666;
    }

    .card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      margin-bottom: 16px;
    }

    .card h2 {
      font-size: 14px;
      color: #333;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid #eee;
    }

    .form-group {
      margin-bottom: 12px;
    }

    .form-group label {
      display: block;
      font-size: 12px;
      color: #666;
      margin-bottom: 4px;
    }

    .settings-section {
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid #eee;
    }

    .settings-section:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    .settings-section h3 {
      font-size: 13px;
      color: #333;
      margin-bottom: 10px;
      font-weight: 600;
    }

    .input-with-btn {
      display: flex;
      gap: 8px;
    }

    .input-with-btn input {
      flex: 1;
    }

    .input-with-btn .btn {
      flex-shrink: 0;
    }

    .form-group input[type="text"],
    .form-group input[type="number"],
    .form-group select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 13px;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #BF0000;
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: #444;
      cursor: pointer;
    }

    .checkbox-label input[type="checkbox"] {
      width: 16px;
      height: 16px;
    }

    .btn {
      padding: 10px 20px;
      font-size: 13px;
      font-weight: 600;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-primary {
      background: #28a745;
      color: white;
    }

    .btn-primary:hover {
      background: #218838;
    }

    .btn-success {
      background: #28a745;
      color: white;
    }

    .btn-success:hover {
      background: #218838;
    }

    .btn-large {
      width: 100%;
      padding: 20px 16px;
      font-size: 16px;
      font-weight: 600;
    }

    .btn-danger {
      background: #dc3545;
      color: white;
    }

    .btn-danger:hover {
      background: #c82333;
    }

    .btn-stop {
      background: #dc3545;
      color: white;
    }

    .btn-stop:hover {
      background: #c82333;
    }

    .btn-secondary {
      background: #f0f0f0;
      color: #666;
    }

    .btn-secondary:hover {
      background: #e0e0e0;
    }

    .btn-sm {
      padding: 4px 10px;
      font-size: 11px;
    }

    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .btn-group {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .status-message {
      padding: 10px;
      border-radius: 6px;
      font-size: 12px;
      margin-top: 10px;
      display: none;
    }

    .status-message.success {
      background: #e8f5e9;
      color: #2e7d32;
      display: block;
    }

    .status-message.error {
      background: #ffebee;
      color: #c62828;
      display: block;
    }

    .status-message.info {
      background: #e3f2fd;
      color: #1565c0;
      display: block;
    }

    /* ã‚­ãƒ¥ãƒ¼è¿½åŠ ã‚¿ãƒ– */
    .tab-container {
      margin-bottom: 16px;
    }

    .tab-buttons {
      display: flex;
      border-bottom: 2px solid #eee;
      margin-bottom: 16px;
    }

    .tab-btn {
      padding: 10px 20px;
      background: none;
      border: none;
      font-size: 13px;
      color: #666;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      margin-bottom: -2px;
      transition: all 0.2s;
    }

    .tab-btn:hover {
      color: #BF0000;
    }

    .tab-btn.active {
      color: #BF0000;
      border-bottom-color: #BF0000;
      font-weight: 600;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* ã‚­ãƒ¥ãƒ¼ä¸€è¦§ */
    .queue-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid #eee;
    }

    .queue-header h2 {
      font-size: 14px;
      color: #333;
      margin: 0;
      padding: 0;
      border: none;
    }

    .queue-count {
      font-size: 12px;
      color: #BF0000;
      font-weight: 600;
    }

    .queue-list {
      max-height: 380px;
      overflow-y: auto;
      margin-bottom: 12px;
    }

    .queue-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 10px;
      border: 1px solid #eee;
      border-radius: 6px;
      margin-bottom: 6px;
      background: #fafafa;
      gap: 8px;
    }

    .queue-item:last-child {
      margin-bottom: 0;
    }

    .queue-item.collecting {
      background: #fff3e0;
      border-color: #ffcc80;
    }

    .collecting-badge {
      display: inline-block;
      background: #ff9800;
      color: white;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: 600;
      margin-right: 6px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    .queue-item-info {
      flex: 1;
      min-width: 0;
      overflow: hidden;
    }

    .queue-item-title {
      font-size: 12px;
      font-weight: 600;
      color: #333;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .queue-item-url {
      font-size: 10px;
      color: #888;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .queue-item-remove {
      background: none;
      border: none;
      color: #dc3545;
      cursor: pointer;
      padding: 4px 8px;
      font-size: 14px;
      flex-shrink: 0;
    }

    .queue-item-remove:hover {
      background: #ffebee;
      border-radius: 4px;
    }

    .queue-empty {
      text-align: center;
      color: #888;
      font-size: 12px;
      padding: 20px;
    }

    /* ãƒ­ã‚° */
    .log-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid #eee;
    }

    .log-header h2 {
      font-size: 14px;
      color: #333;
      margin: 0;
      padding: 0;
      border: none;
    }

    .log-actions {
      display: flex;
      gap: 8px;
    }

    .icon-btn {
      background: #f0f0f0;
      border: none;
      padding: 6px;
      border-radius: 4px;
      cursor: pointer;
      color: #666;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .icon-btn:hover {
      background: #e0e0e0;
      color: #333;
    }

    .log-container {
      max-height: 600px;
      overflow-y: auto;
      background: #f8f9fa;
      border-radius: 6px;
      padding: 12px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 11px;
      color: #333;
      border: 1px solid #eee;
    }

    .log-entry {
      margin-bottom: 4px;
      line-height: 1.4;
    }

    .log-entry .time {
      color: #BF0000;
    }

    .log-entry.error {
      color: #dc3545;
    }

    .log-entry.success {
      color: #28a745;
    }

    /* ãƒªãƒ³ã‚¯ */
    .spreadsheet-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 10px 16px;
      background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 600;
    }

    .spreadsheet-link:hover {
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
    }

    .help-text {
      font-size: 11px;
      color: #888;
      margin-top: 8px;
    }

    /* èª¬æ˜æŠ˜ã‚ŠãŸãŸã¿ */
    .collapsible {
      cursor: pointer;
      font-size: 11px;
      color: #BF0000;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: none;
      border: none;
      padding: 0;
    }

    .collapsible:hover {
      text-decoration: underline;
    }

    .collapsible-content {
      display: none;
      margin-top: 10px;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 6px;
      font-size: 11px;
      color: #666;
      line-height: 1.6;
    }

    .collapsible-content.show {
      display: block;
    }

    .collapsible-content ol {
      margin-left: 20px;
    }

    .collapsible-content li {
      margin-bottom: 6px;
    }

    .collapsible-content code {
      background: #e9ecef;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: monospace;
    }

    .input-row {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 12px;
    }

    .input-flex {
      flex: 1;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 13px;
    }

    .input-flex:focus {
      outline: none;
      border-color: #BF0000;
    }

    .ranking-count-wrapper {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
      color: #666;
    }

    .ranking-count-wrapper input[type="number"] {
      width: 60px;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 13px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="header">
      <div class="header-top">
        <h1>æ¥½å¤©ãƒ¬ãƒ“ãƒ¥ãƒ¼åé›†</h1>
        <div class="header-actions">
          <a id="spreadsheetLink" href="#" target="_blank" class="header-link" style="display: none;" title="ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ã">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z"/></svg>
          </a>
          <button id="downloadBtn" class="header-icon-btn" title="CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰" disabled>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
          </button>
          <button id="settingsToggleBtn" class="header-icon-btn" title="å‡ºåŠ›è¨­å®š">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
          </button>
          <button id="helpToggleBtn" class="header-icon-btn" title="ãƒ˜ãƒ«ãƒ—">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg>
          </button>
        </div>
      </div>
    </div>

    <!-- å‡ºåŠ›è¨­å®šï¼ˆæŠ˜ã‚ŠãŸãŸã¿ï¼‰ -->
    <div id="settingsCard" class="help-card">
      <h2>å‡ºåŠ›è¨­å®š</h2>

      <!-- CSV -->
      <div class="settings-section">
        <h3>CSV</h3>
        <div id="dataButtons" class="btn-group">
          <button id="clearDataBtn" class="btn btn-danger" disabled>åé›†ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢</button>
        </div>
        <p class="help-text" style="margin-top: 8px;">CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¯ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚¢ã‚¤ã‚³ãƒ³ã‹ã‚‰</p>
      </div>

      <!-- ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ -->
      <div class="settings-section">
        <h3>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ</h3>
        <div class="form-group">
          <label>GAS Web App URL</label>
          <div class="input-with-btn">
            <input type="text" id="gasUrl" placeholder="https://script.google.com/macros/s/xxx/exec">
            <button id="saveSettingsBtn" class="btn btn-primary">ä¿å­˜</button>
          </div>
        </div>

        <label class="checkbox-label">
          <input type="checkbox" id="separateSheets" checked>
          <span>å•†å“ã”ã¨ã«ã‚·ãƒ¼ãƒˆã‚’åˆ†ã‘ã‚‹</span>
        </label>

        <div id="settingsStatus" class="status-message"></div>

        <button id="gasHelpToggle" class="collapsible">
          <span id="gasHelpIcon">â–¶</span> GAS Web App URLã®å–å¾—æ–¹æ³•
        </button>
        <div id="gasHelp" class="collapsible-content">
          <ol>
            <li>Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ</li>
            <li>æ‹¡å¼µæ©Ÿèƒ½ â†’ Apps Script ã‚’é–‹ã</li>
            <li>ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘:
              <br><code>gas/Code.gs</code> ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼
            </li>
            <li>ãƒ‡ãƒ—ãƒ­ã‚¤ â†’ æ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤</li>
            <li>ç¨®é¡: ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒª</li>
            <li>ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼: å…¨å“¡</li>
            <li>ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä¸Šè¨˜ã«è²¼ã‚Šä»˜ã‘</li>
          </ol>
          <h4 style="margin-top: 12px; margin-bottom: 8px; color: #BF0000;">GASã‚³ãƒ¼ãƒ‰ã®æ›´æ–°æ–¹æ³•</h4>
          <ol>
            <li>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ â†’ æ‹¡å¼µæ©Ÿèƒ½ â†’ Apps Script ã‚’é–‹ã</li>
            <li>Code.gs ã®å†…å®¹ã‚’æœ€æ–°ç‰ˆã«ç½®ãæ›ãˆ</li>
            <li>ãƒ‡ãƒ—ãƒ­ã‚¤ â†’ ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ç®¡ç† â†’ ç·¨é›†ï¼ˆé‰›ç­†ã‚¢ã‚¤ã‚³ãƒ³ï¼‰</li>
            <li>ãƒãƒ¼ã‚¸ãƒ§ãƒ³: ã€Œæ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€ã‚’é¸æŠ</li>
            <li>ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
          </ol>
          <p style="margin-top: 8px; color: #888;">â€»URLã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚³ãƒ¼ãƒ‰æ›´æ–°å¾Œã¯å¿…ãšæ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãã ã•ã„ã€‚</p>

          <h4 style="margin-top: 16px; margin-bottom: 8px; color: #BF0000;">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®åˆæœŸåŒ–æ©Ÿèƒ½</h4>
          <p style="margin-bottom: 8px;">GASã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ã™ã‚‹ã¨ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã€ŒğŸ› ï¸ ãƒ¬ãƒ“ãƒ¥ãƒ¼ç®¡ç†ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚</p>
          <ol>
            <li>ä¸Šè¨˜ã€ŒGASã‚³ãƒ¼ãƒ‰ã®æ›´æ–°æ–¹æ³•ã€ã§ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°</li>
            <li>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ãç›´ã™ï¼ˆã¾ãŸã¯ãƒšãƒ¼ã‚¸æ›´æ–°ï¼‰</li>
            <li>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã«ã€ŒğŸ› ï¸ ãƒ¬ãƒ“ãƒ¥ãƒ¼ç®¡ç†ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹</li>
            <li>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨:
              <ul style="margin-top: 4px; margin-left: 16px;">
                <li><strong>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’åˆæœŸåŒ–</strong> - å…¨ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤</li>
                <li><strong>ç©ºã®ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤</strong> - ãƒ‡ãƒ¼ã‚¿ã®ãªã„ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤</li>
                <li><strong>é‡è¤‡ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å‰Šé™¤</strong> - é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤</li>
              </ul>
            </li>
          </ol>
        </div>
      </div>
    </div>

    <!-- ãƒ˜ãƒ«ãƒ—ï¼ˆæŠ˜ã‚ŠãŸãŸã¿ï¼‰ -->
    <div id="helpCard" class="help-card">
      <h2>ãƒ˜ãƒ«ãƒ—</h2>
      <div class="help-section">
        <h3>åŸºæœ¬çš„ãªä½¿ã„æ–¹</h3>
        <ol>
          <li><strong>å˜ä¸€å•†å“ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼åé›†:</strong>
            <br>æ¥½å¤©å¸‚å ´ã®å•†å“ãƒšãƒ¼ã‚¸ã¾ãŸã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒšãƒ¼ã‚¸ã‚’é–‹ãã€æ‹¡å¼µæ©Ÿèƒ½ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ ã€Œåé›†é–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™
          </li>
          <li><strong>è¤‡æ•°å•†å“ã®ä¸€æ‹¬åé›†:</strong>
            <br>å„å•†å“ãƒšãƒ¼ã‚¸ã§ã€Œã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã€â†’ ã“ã®ç”»é¢ã§ã€Œä¸€æ‹¬åé›†é–‹å§‹ã€
          </li>
          <li><strong>ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‹ã‚‰ä¸€æ‹¬è¿½åŠ :</strong>
            <br>æ¥½å¤©ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒšãƒ¼ã‚¸ã®URLã‚’å…¥åŠ› â†’ ä¸Šä½Nå•†å“ã‚’æŒ‡å®š â†’ ã€Œè¿½åŠ ã€
            <br>ã¾ãŸã¯ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒšãƒ¼ã‚¸ã§æ‹¡å¼µæ©Ÿèƒ½ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ å•†å“æ•°ã‚’æŒ‡å®šã—ã¦è¿½åŠ 
          </li>
        </ol>

        <h3>ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜æ–¹æ³•</h3>
        <ul>
          <li><strong>CSVãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰:</strong> GAS URLãŒç©ºã®å ´åˆã€CSVãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</li>
          <li><strong>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ‰:</strong> GAS Web App URLã‚’è¨­å®šã™ã‚‹ã¨ã€è‡ªå‹•ã§Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜</li>
        </ul>

        <h3>åé›†ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿</h3>
        <p>ãƒ¬ãƒ“ãƒ¥ãƒ¼æ—¥ã€å•†å“ç®¡ç†ç•ªå·ã€å•†å“åã€å•†å“URLã€è©•ä¾¡ã€ã‚¿ã‚¤ãƒˆãƒ«ã€æœ¬æ–‡ã€æŠ•ç¨¿è€…ã€å¹´ä»£ã€æ€§åˆ¥ã€æ³¨æ–‡æ—¥ã€ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã€ç”¨é€”ã€è´ˆã‚Šå…ˆã€è³¼å…¥å›æ•°ã€è³¼å…¥æƒ…å ±ã€å‚è€ƒã«ãªã£ãŸæ•°ã€ã‚·ãƒ§ãƒƒãƒ—åã€ãƒšãƒ¼ã‚¸URLã€åé›†æ—¥æ™‚</p>

        <h3>æ³¨æ„äº‹é …</h3>
        <ul>
          <li>åé›†ä¸­ã¯ã‚¿ãƒ–ã‚’é–‰ã˜ãªã„ã§ãã ã•ã„</li>
          <li>æ¥½å¤©å¸‚å ´ã®ã‚µãƒ¼ãƒãƒ¼è² è·è»½æ¸›ã®ãŸã‚ã€ãƒšãƒ¼ã‚¸é–“ã«3ã€œ6ç§’ã®å¾…æ©Ÿæ™‚é–“ãŒå…¥ã‚Šã¾ã™</li>
          <li>å¤§é‡ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’åé›†ã™ã‚‹å ´åˆã¯æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™</li>
        </ul>
      </div>
    </div>

    <!-- ã‚­ãƒ¥ãƒ¼ -->
    <div class="card">
      <div class="queue-header">
        <h2>ã‚­ãƒ¥ãƒ¼</h2>
        <span id="queueRemaining" class="queue-count">0ä»¶</span>
      </div>

      <!-- URLå…¥åŠ›ã‚¨ãƒªã‚¢ -->
      <div class="input-row">
        <input type="text" id="productUrl" class="input-flex" placeholder="å•†å“ãƒšãƒ¼ã‚¸URLã¾ãŸã¯ãƒ©ãƒ³ã‚­ãƒ³ã‚°URL">
        <div id="rankingCountWrapper" class="ranking-count-wrapper" style="display: none;">
          <span>ä¸Šä½</span>
          <input type="number" id="rankingCount" value="10" min="1" max="100">
          <span>ä»¶</span>
        </div>
        <button id="addToQueueBtn" class="btn btn-primary">è¿½åŠ </button>
      </div>
      <div id="addStatus" class="status-message"></div>

      <!-- ã‚­ãƒ¥ãƒ¼ãƒªã‚¹ãƒˆ -->
      <div id="queueList" class="queue-list">
        <div class="queue-empty">ã‚­ãƒ¥ãƒ¼ã¯ç©ºã§ã™</div>
      </div>

      <div style="margin-top: 12px;">
        <button id="startQueueBtn" class="btn btn-success btn-large" disabled>ä¸€æ‹¬åé›†é–‹å§‹</button>
        <button id="stopQueueBtn" class="btn btn-stop btn-large" style="display: none;">åé›†ä¸­æ­¢</button>
      </div>
      <div style="margin-top: 8px; text-align: right;">
        <button id="clearQueueBtn" class="btn btn-secondary">ã‚­ãƒ¥ãƒ¼ã‚¯ãƒªã‚¢</button>
      </div>
    </div>

    <!-- ãƒ­ã‚° -->
    <div id="logCard" class="card" style="display: none;">
      <div class="log-header">
        <h2>ãƒ­ã‚°</h2>
        <div class="log-actions">
          <button id="copyLogBtn" class="icon-btn" title="ãƒ­ã‚°ã‚’ã‚³ãƒ”ãƒ¼">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
          </button>
          <button id="clearLogBtn" class="icon-btn" title="ã‚¯ãƒªã‚¢">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
          </button>
        </div>
      </div>
      <div id="logContainer" class="log-container"></div>
    </div>
  </div>

  <script src="jszip.min.js"></script>
  <script src="options.js"></script>
</body>
</html>
