<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¥½å¤©ãƒ¬ãƒ“ãƒ¥ãƒ¼åé›† - è¨­å®š</title>
  <style>
    /* === CSS Variables === */
    :root {
      /* Brand Colors */
      --rakuten-red: #BF0000;
      --rakuten-red-light: #E53935;
      --rakuten-red-dark: #8B0000;

      /* Light Mode - çˆ½ã‚„ã‹ãªã‚¹ã‚«ã‚¤ãƒ–ãƒ«ãƒ¼ */
      --bg-gradient-1: #74b9ff;
      --bg-gradient-2: #00cec9;
      --bg-glass: rgba(255, 255, 255, 0.25);
      --bg-glass-hover: rgba(255, 255, 255, 0.35);
      --bg-card: rgba(255, 255, 255, 0.7);
      --bg-input: rgba(255, 255, 255, 0.8);
      --text-primary: #1a1a2e;
      --text-secondary: #444;
      --text-muted: #666;
      --border-glass: rgba(255, 255, 255, 0.4);
      --border-input: rgba(0, 0, 0, 0.1);
      --shadow-glass: 0 8px 32px rgba(0, 0, 0, 0.1);
      --shadow-card: 0 4px 20px rgba(0, 0, 0, 0.08);

      /* State Colors */
      --success: #28a745;
      --success-light: #34d058;
      --error: #dc3545;
      --warning: #f57c00;
      --info: #17a2b8;

      /* Glass Settings */
      --glass-blur: 20px;
      --border-radius: 12px;
      --border-radius-lg: 16px;
      --transition: 0.25s ease;
    }

    /* Dark Mode */
    [data-theme="dark"] {
      --bg-gradient-1: #1a1a2e;
      --bg-gradient-2: #16213e;
      --bg-glass: rgba(255, 255, 255, 0.08);
      --bg-glass-hover: rgba(255, 255, 255, 0.15);
      --bg-card: rgba(255, 255, 255, 0.08);
      --bg-input: rgba(255, 255, 255, 0.1);
      --text-primary: #f0f0f0;
      --text-secondary: #c0c0c0;
      --text-muted: #888;
      --border-glass: rgba(255, 255, 255, 0.12);
      --border-input: rgba(255, 255, 255, 0.15);
      --shadow-glass: 0 8px 32px rgba(0, 0, 0, 0.3);
      --shadow-card: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    /* === Base Styles === */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', 'Hiragino Sans', 'Yu Gothic', sans-serif;
      background: linear-gradient(135deg, var(--bg-gradient-1) 0%, var(--bg-gradient-2) 100%);
      background-attachment: fixed;
      min-height: 100vh;
      padding: 20px;
      transition: background var(--transition);
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
    }

    /* === Header === */
    .header {
      background: linear-gradient(135deg, var(--rakuten-red) 0%, var(--rakuten-red-dark) 100%);
      color: white;
      padding: 20px;
      border-radius: var(--border-radius-lg);
      margin-bottom: 16px;
      box-shadow: var(--shadow-glass);
      position: relative;
      overflow: hidden;
    }

    .header::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 50%;
      background: linear-gradient(180deg, rgba(255,255,255,0.15) 0%, transparent 100%);
      pointer-events: none;
    }

    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      z-index: 1;
    }

    .header h1 {
      font-size: 20px;
      font-weight: 600;
      letter-spacing: 0.5px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }

    .header-stats {
      display: flex;
      gap: 16px;
    }

    .header-stat {
      text-align: center;
    }

    .header-stat-value {
      font-size: 18px;
      font-weight: 700;
    }

    .header-stat-label {
      font-size: 10px;
      opacity: 0.8;
    }

    /* Header Actions */
    .header-actions {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .header-icon-btn {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      padding: 8px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition);
    }

    .header-icon-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-1px);
    }

    .header-icon-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .header-icon-btn:disabled:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: none;
    }

    .header-link {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      padding: 8px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      transition: all var(--transition);
    }

    .header-link:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-1px);
    }

    /* Theme Toggle */
    .theme-toggle {
      position: relative;
      cursor: pointer;
    }

    .theme-toggle-input {
      opacity: 0;
      width: 0;
      height: 0;
      position: absolute;
    }

    .theme-toggle-label {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 44px;
      height: 22px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 11px;
      padding: 2px;
      cursor: pointer;
      position: relative;
      transition: background var(--transition);
    }

    .theme-toggle-label:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .theme-toggle-label::after {
      content: '';
      position: absolute;
      width: 18px;
      height: 18px;
      background: white;
      border-radius: 50%;
      left: 2px;
      transition: transform var(--transition);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .theme-toggle-input:checked + .theme-toggle-label::after {
      transform: translateX(22px);
    }

    .theme-icon {
      font-size: 10px;
      z-index: 1;
      transition: opacity var(--transition);
    }

    .theme-icon.sun { opacity: 1; margin-left: 4px; }
    .theme-icon.moon { opacity: 0.5; margin-right: 4px; }

    .theme-toggle-input:checked + .theme-toggle-label .theme-icon.sun { opacity: 0.5; }
    .theme-toggle-input:checked + .theme-toggle-label .theme-icon.moon { opacity: 1; }

    /* === Glass Card === */
    .card,
    .help-card {
      background: var(--bg-card);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--border-glass);
      border-radius: var(--border-radius-lg);
      padding: 20px;
      box-shadow: var(--shadow-card);
      margin-bottom: 16px;
      transition: all var(--transition);
    }

    .help-card {
      display: none;
    }

    .help-card.show {
      display: block;
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card h2,
    .help-card h2 {
      font-size: 14px;
      color: var(--text-primary);
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border-glass);
    }

    /* Help Section */
    .help-section {
      font-size: 13px;
      line-height: 1.8;
      color: var(--text-secondary);
    }

    .help-section h3 {
      font-size: 13px;
      color: var(--rakuten-red);
      margin: 16px 0 8px 0;
      padding-bottom: 4px;
      border-bottom: 1px solid var(--border-glass);
    }

    .help-section h3:first-child {
      margin-top: 0;
    }

    .help-section ol,
    .help-section ul {
      margin-left: 20px;
      margin-bottom: 8px;
    }

    .help-section li {
      margin-bottom: 8px;
    }

    .help-section p {
      margin-bottom: 8px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .help-section table {
      font-size: 11px;
      border-collapse: collapse;
      width: 100%;
      margin: 8px 0;
    }

    .help-section td {
      border: 1px solid var(--border-glass);
      padding: 4px;
      background: var(--bg-glass);
    }

    .help-section tr:nth-child(odd) td {
      background: var(--bg-card);
    }

    /* Settings Section */
    .settings-section {
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-glass);
    }

    .settings-section:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    .settings-section h3 {
      font-size: 13px;
      color: var(--text-primary);
      margin-bottom: 10px;
      font-weight: 600;
    }

    /* Form Elements */
    .form-group {
      margin-bottom: 12px;
    }

    .form-group label {
      display: block;
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .form-group input[type="text"],
    .form-group input[type="number"],
    .form-group select {
      width: 100%;
      padding: 10px 12px;
      background: var(--bg-input);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-input);
      border-radius: 8px;
      font-size: 13px;
      color: var(--text-primary);
      transition: all var(--transition);
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--rakuten-red);
      box-shadow: 0 0 0 3px rgba(191, 0, 0, 0.15);
    }

    .input-with-btn {
      display: flex;
      gap: 8px;
    }

    .input-with-btn input {
      flex: 1;
    }

    .input-with-btn .btn {
      flex-shrink: 0;
    }

    /* Checkbox */
    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: var(--text-secondary);
      cursor: pointer;
    }

    .checkbox-label input[type="checkbox"] {
      width: 16px;
      height: 16px;
      accent-color: #666;
    }

    /* === Buttons === */
    .btn {
      padding: 10px 20px;
      font-size: 13px;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all var(--transition);
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 50%;
      background: linear-gradient(180deg, rgba(255,255,255,0.2) 0%, transparent 100%);
      pointer-events: none;
    }

    .btn-primary,
    .btn-success {
      background: linear-gradient(135deg, var(--success) 0%, var(--success-light) 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
    }

    .btn-primary:hover,
    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
    }

    .btn-danger,
    .btn-stop {
      background: linear-gradient(135deg, var(--error) 0%, #e74c5e 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
    }

    .btn-danger:hover,
    .btn-stop:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
    }

    .btn-secondary {
      background: var(--bg-glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: var(--text-primary);
      border: 1px solid var(--border-glass);
    }

    .btn-secondary:hover {
      background: var(--bg-glass-hover);
      transform: translateY(-2px);
    }

    .btn-large {
      padding: 16px;
      font-size: 15px;
      font-weight: 600;
      text-align: center;
      border-radius: 10px;
    }

    .btn-sm {
      padding: 4px 10px;
      font-size: 11px;
    }

    .btn:disabled {
      background: rgba(128, 128, 128, 0.3);
      color: rgba(255, 255, 255, 0.5);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn:active:not(:disabled) {
      transform: translateY(0);
    }

    .btn-group {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    /* Icon Button */
    .icon-btn {
      background: var(--bg-glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-glass);
      padding: 8px;
      border-radius: 8px;
      cursor: pointer;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition);
    }

    .icon-btn:hover {
      background: var(--bg-glass-hover);
      color: var(--text-primary);
      transform: translateY(-1px);
    }

    /* === Status Messages === */
    .status-message {
      padding: 10px 12px;
      border-radius: 8px;
      font-size: 12px;
      margin-top: 10px;
      display: none;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .status-message.success {
      background: rgba(40, 167, 69, 0.15);
      color: var(--success);
      border: 1px solid rgba(40, 167, 69, 0.3);
      display: block;
    }

    .status-message.error {
      background: rgba(220, 53, 69, 0.15);
      color: var(--error);
      border: 1px solid rgba(220, 53, 69, 0.3);
      display: block;
    }

    .status-message.info {
      background: rgba(23, 162, 184, 0.15);
      color: var(--info);
      border: 1px solid rgba(23, 162, 184, 0.3);
      display: block;
    }

    [data-theme="dark"] .status-message.success { color: #5fd47a; }
    [data-theme="dark"] .status-message.error { color: #ff6b7a; }
    [data-theme="dark"] .status-message.info { color: #5dd9f0; }

    /* === Queue === */
    .queue-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border-glass);
    }

    .queue-header h2 {
      font-size: 14px;
      color: var(--text-primary);
      margin: 0;
      padding: 0;
      border: none;
    }

    .queue-count {
      font-size: 12px;
      color: var(--rakuten-red);
      font-weight: 600;
    }

    .queue-list {
      max-height: 380px;
      overflow-y: auto;
    }

    .queue-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      background: var(--bg-glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-glass);
      border-radius: 10px;
      margin-bottom: 8px;
      gap: 8px;
      transition: all var(--transition);
    }

    .queue-item:last-child {
      margin-bottom: 0;
    }

    .queue-item:hover {
      background: var(--bg-glass-hover);
    }

    .queue-item.collecting {
      background: rgba(255, 152, 0, 0.15);
      border-color: rgba(255, 152, 0, 0.4);
    }

    .collecting-badge {
      display: inline-block;
      background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
      color: white;
      padding: 3px 8px;
      border-radius: 6px;
      font-size: 10px;
      font-weight: 600;
      margin-right: 6px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    .queue-item-info {
      flex: 1;
      min-width: 0;
      overflow: hidden;
    }

    .queue-item-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .queue-item-url {
      font-size: 10px;
      color: var(--text-muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .queue-item-remove {
      background: none;
      border: none;
      color: var(--error);
      cursor: pointer;
      padding: 4px 8px;
      font-size: 16px;
      flex-shrink: 0;
      border-radius: 6px;
      transition: all var(--transition);
    }

    .queue-item-remove:hover {
      background: rgba(220, 53, 69, 0.15);
    }

    .queue-empty {
      text-align: center;
      color: var(--text-muted);
      font-size: 12px;
      padding: 20px;
    }

    /* === URL Input === */
    .url-input-row {
      display: flex;
      gap: 8px;
      align-items: flex-start;
    }

    .url-textarea {
      flex: 1;
      padding: 10px 12px;
      background: var(--bg-input);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-input);
      border-radius: 8px;
      font-size: 13px;
      font-family: inherit;
      color: var(--text-primary);
      resize: none;
      line-height: 1.4;
      height: 38px;
      overflow: hidden;
      transition: all var(--transition);
    }

    .url-textarea:focus {
      outline: none;
      border-color: var(--rakuten-red);
      box-shadow: 0 0 0 3px rgba(191, 0, 0, 0.15);
    }

    .url-textarea::placeholder {
      color: var(--text-muted);
      font-size: 11px;
    }

    .btn-add {
      align-self: stretch;
      min-width: 60px;
      padding: 10px 16px;
    }

    .url-input-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 4px;
      min-height: 16px;
    }

    .url-count-label {
      font-size: 11px;
      color: var(--text-muted);
      margin-left: auto;
    }

    .url-count-label.has-urls {
      color: var(--success);
      font-weight: 600;
    }

    .ranking-count-wrapper {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      color: var(--text-secondary);
      white-space: nowrap;
    }

    .ranking-count-wrapper input[type="number"] {
      width: 55px;
      padding: 8px;
      background: var(--bg-input);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-input);
      border-radius: 6px;
      font-size: 13px;
      text-align: center;
      color: var(--text-primary);
    }

    .ranking-count-wrapper input:focus {
      outline: none;
      border-color: var(--rakuten-red);
    }

    /* === Log === */
    .log-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border-glass);
    }

    .log-header h2 {
      font-size: 14px;
      color: var(--text-primary);
      margin: 0;
      padding: 0;
      border: none;
    }

    .log-actions {
      display: flex;
      gap: 8px;
    }

    .log-container {
      max-height: 600px;
      overflow-y: auto;
      background: var(--bg-glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 10px;
      padding: 12px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 11px;
      color: var(--text-primary);
      border: 1px solid var(--border-glass);
    }

    .log-entry {
      margin-bottom: 4px;
      line-height: 1.4;
    }

    .log-entry .time {
      color: var(--text-muted);
    }

    .log-entry.error {
      color: var(--error);
    }

    .log-entry.success {
      color: var(--success);
    }

    [data-theme="dark"] .log-entry.error { color: #ff6b7a; }
    [data-theme="dark"] .log-entry.success { color: #5fd47a; }

    /* === Collapsible === */
    .collapsible {
      cursor: pointer;
      font-size: 12px;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 8px;
      background: var(--bg-glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-glass);
      border-radius: 10px;
      padding: 10px 14px;
      margin-top: 12px;
      width: 100%;
      transition: all var(--transition);
    }

    .collapsible:hover {
      background: var(--bg-glass-hover);
      border-color: var(--rakuten-red);
    }

    .collapsible .toggle-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 20px;
      height: 20px;
      background: linear-gradient(135deg, var(--rakuten-red) 0%, var(--rakuten-red-dark) 100%);
      color: white;
      border-radius: 4px;
      font-size: 10px;
      transition: transform var(--transition);
    }

    .collapsible.open .toggle-icon {
      transform: rotate(90deg);
    }

    .collapsible-content {
      display: none;
      margin-top: 12px;
      padding: 16px;
      background: var(--bg-glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-glass);
      border-radius: 12px;
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.7;
    }

    .collapsible-content.show {
      display: block;
      animation: fadeIn 0.3s ease-out;
    }

    .collapsible-content ol {
      margin-left: 20px;
    }

    .collapsible-content li {
      margin-bottom: 6px;
    }

    .collapsible-content code {
      background: rgba(255, 193, 7, 0.2);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: monospace;
      font-size: 11px;
      color: var(--warning);
    }

    /* Step Card */
    .step-card {
      padding: 0 0 10px 0;
      margin-bottom: 6px;
      border-bottom: 1px solid var(--border-glass);
    }

    .step-card:last-of-type {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }

    .step-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }

    .step-number {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      background: var(--text-muted);
      color: white;
      border-radius: 50%;
      font-size: 10px;
      font-weight: 600;
      flex-shrink: 0;
    }

    .step-title {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 12px;
    }

    .step-content {
      padding-left: 28px;
      color: var(--text-secondary);
      font-size: 12px;
    }

    .step-content ol {
      margin: 6px 0 0 16px;
    }

    .step-content li {
      margin-bottom: 3px;
    }

    /* Code Box */
    .code-box {
      background: var(--bg-glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-glass);
      border-radius: 10px;
      padding: 12px;
      margin-top: 8px;
    }

    .code-box textarea {
      width: 100%;
      height: 100px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 10px;
      background: var(--bg-input);
      border: 1px solid var(--border-input);
      border-radius: 6px;
      padding: 10px;
      resize: vertical;
      color: var(--text-primary);
    }

    .copy-btn {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: linear-gradient(135deg, var(--success) 0%, var(--success-light) 100%);
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 8px;
      transition: all var(--transition);
    }

    .copy-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
    }

    /* Success Box */
    .success-box {
      background: rgba(40, 167, 69, 0.1);
      border: 1px solid rgba(40, 167, 69, 0.3);
      padding: 12px;
      border-radius: 8px;
      margin-top: 10px;
    }

    .success-box strong {
      color: var(--success);
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 4px;
    }

    .success-box span {
      font-size: 11px;
      color: var(--text-secondary);
    }

    [data-theme="dark"] .success-box strong { color: #5fd47a; }

    /* Input Row */
    .input-row {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 12px;
    }

    .input-flex {
      flex: 1;
      padding: 10px 12px;
      background: var(--bg-input);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border-input);
      border-radius: 8px;
      font-size: 13px;
      color: var(--text-primary);
    }

    .input-flex:focus {
      outline: none;
      border-color: var(--rakuten-red);
    }

    /* Spreadsheet Link */
    .spreadsheet-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 10px 16px;
      background: linear-gradient(135deg, var(--success) 0%, var(--success-light) 100%);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      transition: all var(--transition);
    }

    .spreadsheet-link:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
    }

    /* Help Text */
    .help-text {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 8px;
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-glass);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-glass);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-muted);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="header-top">
        <h1>æ¥½å¤©ãƒ¬ãƒ“ãƒ¥ãƒ¼åé›†</h1>
        <div class="header-actions">
          <div class="theme-toggle">
            <input type="checkbox" id="themeToggle" class="theme-toggle-input">
            <label for="themeToggle" class="theme-toggle-label">
              <span class="theme-icon sun">â˜€ï¸</span>
              <span class="theme-icon moon">ğŸŒ™</span>
            </label>
          </div>
          <a id="spreadsheetLink" href="#" target="_blank" class="header-link" style="display: none;" title="ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ã">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z"/></svg>
          </a>
          <button id="downloadBtn" class="header-icon-btn" title="CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰" disabled>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
          </button>
          <button id="settingsToggleBtn" class="header-icon-btn" title="è¨­å®š">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
          </button>
          <button id="helpToggleBtn" class="header-icon-btn" title="ãƒ˜ãƒ«ãƒ—">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Settings Card -->
    <div id="settingsCard" class="help-card">
      <h2>è¨­å®š</h2>

      <!-- Notification -->
      <div class="settings-section">
        <h3>é€šçŸ¥</h3>
        <label class="checkbox-label">
          <input type="checkbox" id="enableNotification" checked>
          <span>åé›†å®Œäº†æ™‚ã«ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—é€šçŸ¥</span>
        </label>
        <label class="checkbox-label" style="margin-top: 8px;">
          <input type="checkbox" id="notifyPerProduct">
          <span>å•†å“ã”ã¨ã«é€šçŸ¥ï¼ˆå…¨ä½“å®Œäº†ã®ã¿ã®å ´åˆã¯OFFï¼‰</span>
        </label>
      </div>

      <!-- CSV -->
      <div class="settings-section">
        <h3>CSV</h3>
        <label class="checkbox-label">
          <input type="checkbox" id="separateCsvFiles" checked>
          <span>å•†å“ã”ã¨ã«CSVã‚’åˆ†ã‘ã‚‹</span>
        </label>
        <div id="dataButtons" class="btn-group" style="margin-top: 8px;">
          <button id="clearDataBtn" class="btn btn-danger btn-sm" disabled>åé›†ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢</button>
        </div>
      </div>

      <!-- Spreadsheet -->
      <div class="settings-section">
        <h3>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ</h3>
        <label class="checkbox-label" style="margin-bottom: 24px;">
          <input type="checkbox" id="separateSheets" checked>
          <span>å•†å“ã”ã¨ã«ã‚·ãƒ¼ãƒˆã‚’åˆ†ã‘ã‚‹</span>
        </label>

        <h4 style="font-size: 13px; color: var(--text-primary); margin-bottom: 12px;">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆé€£æºã®è¨­å®šæ–¹æ³•</h4>
        <div id="gasHelp">
          <p style="margin-bottom: 16px; color: var(--text-secondary); font-size: 12px;">ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«è‡ªå‹•ä¿å­˜ã™ã‚‹ãŸã‚ã®è¨­å®šã§ã™ã€‚</p>

          <div class="step-card">
            <div class="step-header">
              <span class="step-number">1</span>
              <span class="step-title">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ</span>
            </div>
            <div class="step-content">
              Googleãƒ‰ãƒ©ã‚¤ãƒ–ã§æ–°ã—ã„ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
            </div>
          </div>

          <div class="step-card">
            <div class="step-header">
              <span class="step-number">2</span>
              <span class="step-title">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆURLã‚’å…¥åŠ›</span>
            </div>
            <div class="step-content">
              ä½œæˆã—ãŸã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®URLã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚
              <div style="margin-top: 8px;">
                <input type="text" id="spreadsheetUrlForCode" placeholder="https://docs.google.com/spreadsheets/d/xxxxx/edit" style="width: 100%; padding: 10px; background: var(--bg-input); border: 1px solid var(--border-input); border-radius: 6px; font-size: 12px; color: var(--text-primary);">
                <div id="spreadsheetIdStatus" style="font-size: 11px; margin-top: 4px;"></div>
              </div>
            </div>
          </div>

          <div class="step-card">
            <div class="step-header">
              <span class="step-number">3</span>
              <span class="step-title">Apps Scriptã‚’é–‹ã</span>
            </div>
            <div class="step-content">
              ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œæ‹¡å¼µæ©Ÿèƒ½ã€â†’ã€ŒApps Scriptã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚
            </div>
          </div>

          <div class="step-card">
            <div class="step-header">
              <span class="step-number">4</span>
              <span class="step-title">ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ â†’ ä¿å­˜</span>
            </div>
            <div class="step-content">
              <ol style="margin: 0 0 0 16px; padding: 0;">
                <li><code>function myFunction() { }</code> ã¨æ›¸ã‹ã‚Œã¦ã„ã‚‹éƒ¨åˆ†ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li><strong>Ctrl+A</strong>ï¼ˆMacã¯âŒ˜+Aï¼‰ã§å…¨é¸æŠ â†’ <strong>Delete</strong>ã§å‰Šé™¤</li>
                <li style="margin-bottom: 8px;">ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
                  <div style="margin-top: 6px;">
                    <button id="copyGasCodeBtn" class="copy-btn">ğŸ“‹ ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼</button>
                    <textarea id="gasCodeArea" readonly style="display: none;"></textarea>
                  </div>
                </li>
                <li><strong>Ctrl+V</strong>ï¼ˆMacã¯âŒ˜+Vï¼‰ã§è²¼ã‚Šä»˜ã‘</li>
                <li>ğŸ’¾ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆã¾ãŸã¯Ctrl+Sï¼‰ã§ä¿å­˜</li>
              </ol>
            </div>
          </div>

          <div class="step-card">
            <div class="step-header">
              <span class="step-number">5</span>
              <span class="step-title">ãƒ‡ãƒ—ãƒ­ã‚¤ â†’ ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URLã‚’å…¥æ‰‹</span>
            </div>
            <div class="step-content">
              <ol>
                <li>å³ä¸Šã®ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li>âš™ï¸æ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã‚’é¸æŠ</li>
                <li>ã€Œã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ã‚’<strong>ã€Œå…¨å“¡ã€</strong>ã«å¤‰æ›´</li>
                <li>ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li>Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯</li>
                <li>è¡¨ç¤ºã•ã‚ŒãŸ<strong>ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URLã€ã‚’ã‚³ãƒ”ãƒ¼</strong></li>
              </ol>
            </div>
          </div>

          <div class="step-card">
            <div class="step-header">
              <span class="step-number">6</span>
              <span class="step-title">ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URLã‚’è²¼ã‚Šä»˜ã‘ã¦ä¿å­˜</span>
            </div>
            <div class="step-content">
              <div style="margin-top: 4px;">
                <div class="input-with-btn">
                  <input type="text" id="gasUrl" placeholder="https://script.google.com/macros/s/xxx/exec" style="flex: 1; padding: 10px 12px; background: var(--bg-input); border: 1px solid var(--border-input); border-radius: 8px; font-size: 12px; color: var(--text-primary);">
                  <button id="saveSettingsBtn" class="btn btn-primary">ä¿å­˜</button>
                </div>
                <div id="settingsStatus" class="status-message" style="margin-top: 8px;"></div>
              </div>
            </div>
          </div>

          <div class="success-box">
            <strong>âœ… è¨­å®šå®Œäº†å¾Œ</strong>
            <ul style="margin: 8px 0 0 16px; padding: 0; font-size: 12px; color: var(--text-secondary); line-height: 1.8;">
              <li>ãƒ˜ãƒƒãƒ€ãƒ¼ã«ğŸ“Šã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã€ã‚¯ãƒªãƒƒã‚¯ã§ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ã‘ã¾ã™</li>
              <li>ãƒ¬ãƒ“ãƒ¥ãƒ¼åé›†æ™‚ã«è‡ªå‹•ã§ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã‚‚ä¿å­˜ã•ã‚Œã¾ã™ï¼ˆCSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ä½µç”¨å¯èƒ½ï¼‰</li>
              <li>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’æ›´æ–°ã™ã‚‹ã¨ã€ŒğŸ› ï¸ ãƒ¬ãƒ“ãƒ¥ãƒ¼ç®¡ç†ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¿½åŠ ã•ã‚Œã¾ã™</li>
              <li>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆåˆæœŸåŒ–ã€ã€Œé‡è¤‡ãƒ¬ãƒ“ãƒ¥ãƒ¼å‰Šé™¤ã€ãªã©ã®æ©Ÿèƒ½ãŒä½¿ãˆã¾ã™</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Help Card -->
    <div id="helpCard" class="help-card">
      <h2>ãƒ˜ãƒ«ãƒ—</h2>
      <div class="help-section">
        <h3>åŸºæœ¬çš„ãªä½¿ã„æ–¹</h3>
        <ol>
          <li><strong>å˜ä¸€å•†å“ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼åé›†:</strong>
            <br>æ¥½å¤©å¸‚å ´ã®å•†å“ãƒšãƒ¼ã‚¸ã¾ãŸã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒšãƒ¼ã‚¸ã‚’é–‹ãã€æ‹¡å¼µæ©Ÿèƒ½ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ ã€Œåé›†é–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™
            <br>â€»å•†å“ãƒšãƒ¼ã‚¸ã‹ã‚‰ã¯è‡ªå‹•ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒšãƒ¼ã‚¸ã«é·ç§»ã—ã¾ã™
          </li>
          <li><strong>è¤‡æ•°å•†å“ã®ä¸€æ‹¬åé›†ï¼ˆã‚­ãƒ¥ãƒ¼ï¼‰:</strong>
            <br>â‘  å„å•†å“ãƒšãƒ¼ã‚¸ã§ã€Œã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™
            <br>â‘¡ ã“ã®ç®¡ç†ç”»é¢ã§ã€Œä¸€æ‹¬åé›†é–‹å§‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
            <br>â€»æœ€å¤§3å•†å“ã‚’åŒæ™‚ã«åé›†ï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã®åˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§å®Ÿè¡Œï¼‰
          </li>
          <li><strong>ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‹ã‚‰ä¸€æ‹¬è¿½åŠ :</strong>
            <br>ã€æ–¹æ³•1ã€‘æ¥½å¤©ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒšãƒ¼ã‚¸ã‚’é–‹ãã€æ‹¡å¼µæ©Ÿèƒ½ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ å•†å“æ•°ã‚’æŒ‡å®šã—ã¦è¿½åŠ 
            <br>ã€æ–¹æ³•2ã€‘ã“ã®ç®¡ç†ç”»é¢ã§ãƒ©ãƒ³ã‚­ãƒ³ã‚°URLã‚’å…¥åŠ› â†’ ä¸Šä½Nå•†å“ã‚’æŒ‡å®š â†’ ã€Œè¿½åŠ ã€
          </li>
        </ol>

        <h3>ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜æ–¹æ³•</h3>
        <ul>
          <li><strong>CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰:</strong>
            <br>ãƒ˜ãƒƒãƒ€ãƒ¼ã®ğŸ“¥ã‚¢ã‚¤ã‚³ãƒ³ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆå¸¸ã«åˆ©ç”¨å¯èƒ½ï¼‰
            <br>ã€Œå•†å“ã”ã¨ã«CSVã‚’åˆ†ã‘ã‚‹ã€ONã®å ´åˆã¯ZIPãƒ•ã‚¡ã‚¤ãƒ«ã§ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
          </li>
          <li><strong>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆè‡ªå‹•ä¿å­˜ï¼ˆæ¨å¥¨ï¼‰:</strong>
            <br>ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URLã‚’è¨­å®šã™ã‚‹ã¨ã€åé›†æ™‚ã«è‡ªå‹•ã§Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜
            <br>ã€Œå•†å“ã”ã¨ã«ã‚·ãƒ¼ãƒˆã‚’åˆ†ã‘ã‚‹ã€ONã§å•†å“åˆ¥ã«ã‚·ãƒ¼ãƒˆä½œæˆ
            <br>â€»CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ä½µç”¨å¯èƒ½
          </li>
        </ul>

        <h3>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h3>
        <p>GASã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹ã¨ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã€ŒğŸ› ï¸ ãƒ¬ãƒ“ãƒ¥ãƒ¼ç®¡ç†ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¿½åŠ ã•ã‚Œã¾ã™ï¼ˆè¦æ›´æ–°ï¼‰</p>
        <ul>
          <li><strong>ğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’åˆæœŸåŒ–:</strong>
            <br>ã™ã¹ã¦ã®ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤ã—ã€åˆæœŸåŒ–æ¸ˆã¿ã®ã€Œãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ
          </li>
          <li><strong>ğŸ”„ é‡è¤‡ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å‰Šé™¤:</strong>
            <br>å…¨ã‚·ãƒ¼ãƒˆã‹ã‚‰é‡è¤‡ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ¤œå‡ºã—ã¦å‰Šé™¤ï¼ˆæœ¬æ–‡+æŠ•ç¨¿è€…+æ—¥ä»˜ã§åˆ¤å®šï¼‰
          </li>
        </ul>

        <h3>åé›†ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ï¼ˆ20é …ç›®ï¼‰</h3>
        <table>
          <tr>
            <td>ãƒ¬ãƒ“ãƒ¥ãƒ¼æ—¥</td>
            <td>å•†å“ç®¡ç†ç•ªå·</td>
            <td>å•†å“å</td>
            <td>å•†å“URL</td>
          </tr>
          <tr>
            <td>è©•ä¾¡ï¼ˆ1-5ï¼‰</td>
            <td>ã‚¿ã‚¤ãƒˆãƒ«</td>
            <td>æœ¬æ–‡</td>
            <td>æŠ•ç¨¿è€…</td>
          </tr>
          <tr>
            <td>å¹´ä»£</td>
            <td>æ€§åˆ¥</td>
            <td>æ³¨æ–‡æ—¥</td>
            <td>ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³</td>
          </tr>
          <tr>
            <td>ç”¨é€”</td>
            <td>è´ˆã‚Šå…ˆ</td>
            <td>è³¼å…¥å›æ•°</td>
            <td>å‚è€ƒã«ãªã£ãŸæ•°</td>
          </tr>
          <tr>
            <td>ã‚·ãƒ§ãƒƒãƒ—ã‹ã‚‰ã®è¿”ä¿¡</td>
            <td>ã‚·ãƒ§ãƒƒãƒ—å</td>
            <td>ãƒ¬ãƒ“ãƒ¥ãƒ¼æ²è¼‰URL</td>
            <td>åé›†æ—¥æ™‚</td>
          </tr>
        </table>

        <h3>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ</h3>
        <ul>
          <li><strong>Alt + R:</strong> ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’é–‹ãï¼ˆåé›†é–‹å§‹/åœæ­¢ï¼‰</li>
          <li><strong>Alt + Shift + R:</strong> ç®¡ç†ç”»é¢ï¼ˆã“ã®ç”»é¢ï¼‰ã‚’é–‹ã</li>
        </ul>

        <h3>é€šçŸ¥è¨­å®š</h3>
        <ul>
          <li><strong>åé›†å®Œäº†æ™‚ã«ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—é€šçŸ¥:</strong> å…¨å•†å“ã®åé›†ãŒå®Œäº†ã—ãŸæ™‚ã«é€šçŸ¥</li>
          <li><strong>å•†å“ã”ã¨ã«é€šçŸ¥:</strong> å„å•†å“ã®åé›†å®Œäº†æ™‚ã«ã‚‚é€šçŸ¥ï¼ˆå¤§é‡åé›†æ™‚ã¯ OFF æ¨å¥¨ï¼‰</li>
        </ul>

        <h3>å¯¾å¿œãƒšãƒ¼ã‚¸</h3>
        <ul>
          <li><strong>å•†å“ãƒšãƒ¼ã‚¸:</strong> item.rakuten.co.jp/*</li>
          <li><strong>ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒšãƒ¼ã‚¸:</strong> review.rakuten.co.jp/*</li>
          <li><strong>ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒšãƒ¼ã‚¸:</strong> ranking.rakuten.co.jp/*</li>
        </ul>

        <h3>åé›†ã®ä»•çµ„ã¿</h3>
        <ul>
          <li>ã‚­ãƒ¥ãƒ¼åé›†æ™‚ã¯æœ€å¤§<strong>3å•†å“ã‚’åŒæ™‚ã«ä¸¦åˆ—å‡¦ç†</strong></li>
          <li>ã‚µãƒ¼ãƒãƒ¼è² è·è»½æ¸›ã®ãŸã‚ã€ãƒšãƒ¼ã‚¸é–“ã«<strong>3ã€œ6ç§’ã®ãƒ©ãƒ³ãƒ€ãƒ å¾…æ©Ÿ</strong></li>
          <li>åé›†ç”¨ã®æœ€å°åŒ–ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§è‡ªå‹•å®Ÿè¡Œï¼ˆé€šå¸¸ã®ä½œæ¥­ã‚’å¦¨ã’ã¾ã›ã‚“ï¼‰</li>
          <li>å„å•†å“ã®åé›†å®Œäº†å¾Œã€ã‚¿ãƒ–ã¯è‡ªå‹•ã§é–‰ã˜ã‚‰ã‚Œã¾ã™</li>
        </ul>

        <h3>æ³¨æ„äº‹é …</h3>
        <ul>
          <li><strong>å˜ä¸€åé›†æ™‚:</strong> åé›†ä¸­ã®ã‚¿ãƒ–ã‚’é–‰ã˜ã‚‹ã¨ä¸­æ–­ã•ã‚Œã¾ã™</li>
          <li><strong>ã‚­ãƒ¥ãƒ¼åé›†æ™‚:</strong> åé›†ç”¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ã‚‹ã¨å…¨ã¦ä¸­æ–­ã•ã‚Œã¾ã™</li>
          <li>æ¥½å¤©å¸‚å ´ã®ãƒšãƒ¼ã‚¸æ§‹é€ å¤‰æ›´ã«ã‚ˆã‚Šã€åé›†ã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™</li>
          <li>å¤§é‡ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼åé›†ã«ã¯æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ï¼ˆ1ãƒšãƒ¼ã‚¸ç´„15ä»¶ã€3-6ç§’/ãƒšãƒ¼ã‚¸ï¼‰</li>
          <li>ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒšãƒ¼ã‚¸ã‹ã‚‰ç›´æ¥åé›†ã‚’é–‹å§‹ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™</li>
        </ul>

        <h3>ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h3>
        <ul>
          <li><strong>ã€Œãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹:</strong>
            <br>â†’ ãƒšãƒ¼ã‚¸ã‚’F5ã§ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‹ã‚‰å†åº¦åé›†ã‚’é–‹å§‹ã—ã¦ãã ã•ã„
          </li>
          <li><strong>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜ã•ã‚Œãªã„:</strong>
            <br>â†’ ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URLãŒæ­£ã—ã„ã‹ç¢ºèªã€‚ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URLã€ã‚’ä½¿ç”¨
          </li>
          <li><strong>ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œãªã„:</strong>
            <br>â†’ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’æ›´æ–°ï¼ˆCtrl+Rï¼‰ã—ã¦ãã ã•ã„
          </li>
          <li><strong>ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒåé›†ã•ã‚Œãªã„:</strong>
            <br>â†’ æ¥½å¤©ã®æ–°ã—ã„ãƒšãƒ¼ã‚¸æ§‹é€ ã«å¯¾å¿œã—ã¦ã„ãªã„å¯èƒ½æ€§ã€‚æ‹¡å¼µæ©Ÿèƒ½ã®æ›´æ–°ã‚’ç¢ºèª
          </li>
        </ul>

        <h3>ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±</h3>
        <p>æ¥½å¤©å¸‚å ´ãƒ¬ãƒ“ãƒ¥ãƒ¼åé›† v1.3.5</p>
      </div>
    </div>

    <!-- Queue Card -->
    <div class="card">
      <div class="queue-header">
        <h2>ã‚­ãƒ¥ãƒ¼</h2>
        <div style="display: flex; align-items: center; gap: 8px;">
          <span id="queueRemaining" class="queue-count">0ä»¶</span>
          <button id="clearQueueBtn" class="icon-btn" title="ã‚­ãƒ¥ãƒ¼ã‚¯ãƒªã‚¢">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
          </button>
        </div>
      </div>

      <!-- URL Input -->
      <div class="url-input-row">
        <textarea id="productUrl" class="url-textarea" placeholder="å•†å“ãƒšãƒ¼ã‚¸URLï¼ˆæ”¹è¡Œã§è¤‡æ•°å¯ï¼‰ã¾ãŸã¯ãƒ©ãƒ³ã‚­ãƒ³ã‚°URLã‚’å…¥åŠ›"></textarea>
        <div id="rankingCountWrapper" class="ranking-count-wrapper" style="display: none;">
          <span>ä¸Šä½</span>
          <input type="number" id="rankingCount" value="10" min="1" max="100">
          <span>ä»¶</span>
        </div>
        <button id="addToQueueBtn" class="btn btn-primary btn-add">è¿½åŠ </button>
      </div>
      <div class="url-input-footer">
        <span id="urlCountLabel" class="url-count-label"></span>
      </div>
      <div id="addStatus" class="status-message"></div>

      <div style="margin-top: 8px; margin-bottom: 8px;">
        <button id="startQueueBtn" class="btn btn-success btn-large" style="width: 100%;" disabled>ä¸€æ‹¬åé›†é–‹å§‹</button>
        <button id="stopQueueBtn" class="btn btn-stop btn-large" style="width: 100%; display: none;">åé›†ä¸­æ­¢</button>
      </div>

      <!-- Queue List -->
      <div id="queueList" class="queue-list"></div>
    </div>

    <!-- Log Card -->
    <div id="logCard" class="card" style="display: none;">
      <div class="log-header">
        <h2>ãƒ­ã‚°</h2>
        <div class="log-actions">
          <button id="copyLogBtn" class="icon-btn" title="ãƒ­ã‚°ã‚’ã‚³ãƒ”ãƒ¼">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
          </button>
          <button id="clearLogBtn" class="icon-btn" title="ã‚¯ãƒªã‚¢">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
          </button>
        </div>
      </div>
      <div id="logContainer" class="log-container"></div>
    </div>
  </div>

  <script src="jszip.min.js"></script>
  <script src="options.js"></script>
</body>
</html>
